{% extends 'website/layout.html' %}
{% load static %}

{% block title %}
Asthetic Procedure Appointments
{% endblock %}

{% block body %}
<div class="container-fluid">
  <h3>Active Appointments</h3>
  <form method="post" action="{% url 'manage_appointments' %}">
      {% csrf_token %}
      <table class="table table-striped table-hover table-group-divider">
          <thead>
              <tr>
                  <th scope="col"><input type="checkbox" id="select-all"></th>
                  <th scope="col">ID</th>
                  <th scope="col">Patient's name</th>
                  <th scope="col">Email</th>
                  <th scope="col">Phone number</th>
                  <th scope="col">Procedure</th>
                  <th scope="col">Appointment date</th>
                  <th scope="col">Remarks</th>
                  <th scope="col">Date Added</th>
                  <th scope="col">Booked by</th>
                  <th scope="col">Actions</th>
              </tr>
          </thead>
          <tbody class="table-group-divider my-lg-5">
              {% if patients %}
                  {% for patient in patients %}
                      <tr>
                          <td><input type="checkbox" name="selected_appointments" value="{{ patient.id }}"></td>
                          <td>{{ patient.id }}</td>
                          <td>{{ patient.first_name }} {{ patient.last_name }}</td>
                          <td>{{ patient.email }}</td>
                          <td>{{ patient.phone_number }}</td>
                          <td>{{ patient.service }}</td>
                          <td>{{ patient.appt_date }}</td>
                          <td>{{ patient.details }}</td>
                          <td>{{ patient.date_added }}</td>
                          <td>{{ patient.user }}</td>
                          <td>
                              <a href="{% url 'edit_appointment' patient.id %}" class="btn btn-primary btn-sm">Edit</a>
                              <a href="{% url 'rebook_appointment' patient.id %}" class="btn btn-warning btn-sm">Rebook</a>
                              <a href="{% url 'cancel_appointment' patient.id %}" class="btn btn-secondary btn-sm">Cancel</a>
                              <a href="{% url 'delete_appointment' patient.id %}" class="btn btn-danger btn-sm">Delete</a>
                          </td>
                      </tr>
                  {% endfor %}
              {% else %}
                  <tr>
                      <td colspan="11">No active appointments.</td>
                  </tr>
              {% endif %}
          </tbody>
      </table>
  </form>
</div>

<script>
  document.getElementById('select-all').addEventListener('change', function() {
      var checkboxes = document.querySelectorAll('input[name="selected_appointments"]');
      checkboxes.forEach(checkbox => checkbox.checked = this.checked);
  });
</script>


<br />
<hr />
{% endblock %}