{% extends 'website/layout.html' %}
{% load static %}

{% block title %}
Asthetic Procedure Appointments
{% endblock %}

{% block body %}

<div class="container-fluid">
    <h3>Active Appointments</h3>
    <form method="post" action="{% url 'manage_appointments' %}">
        {% csrf_token %}
        <table class="table table-striped table-hover table-group-divider">
            <thead>
                <tr>
                    <th scope="col"></th>
                    <th scope="col">ID</th>
                    <th scope="col">Patient's name</th>
                    <th scope="col">Email</th>
                    <th scope="col">Phone number</th>
                    <th scope="col">Procedure</th>
                    <th scope="col">Appointment date</th>
                    <th scope="col">Remarks</th>
                    <th scope="col">Date Added</th>
                    <th scope="col">Booked by</th>
                    <th scope="col">Actions</th>
                </tr>
            </thead>
            <tbody class="table-group-divider my-lg-5">
                {% if patients %}
                {% for patient in patients %}
                <tr {% if not patient.is_active %} class="table-secondary text-muted" {% endif %}>
                    <td><input type="checkbox" name="selected_appointments" value="{{ patient.id }}"></td>
                    <td>{{ patient.id }}</td>
                    <td>{{ patient.first_name }} {{ patient.last_name }}</td>
                    <td>{{ patient.email }}</td>
                    <td>{{ patient.phone_number }}</td>
                    <td>{{ patient.service }}</td>
                    <td>{{ patient.appt_date }}</td>
                    <td>{{ patient.details }}</td>
                    <td>{{ patient.date_added }}</td>
                    <td>{{ patient.user }}</td>
                    <td>
                        {% if patient.is_active %}
                        <a href="{% url 'edit_appointment' patient.id %}" class="badge rounded-pill text-bg-info">Edit</a>
                        <a href="{% url 'cancel_appointment' patient.id %}" class="badge rounded-pill text-bg-warning">Cancel</a>
                        <a href="{% url 'delete_appointment' patient.id %}" class="badge rounded-pill text-bg-danger">Delete</a>
                        {% else %}
                        <span class="badge bg-secondary">Canceled</span>
                        <a href="{% url 'edit_appointment' patient.id %}" class="badge rounded-pill text-bg-info">Edit</a>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
                {% endif %}
            </tbody>
        </table>
        <div class="d-flex justify-content-start">
            <div>
                <select name="action" class="form-select form-select-sm">
                    <option>Batch options</option>
                    <option value="delete">Delete</option>
                    <option value="cancel">Cancel</option>
                    <!-- Add other actions here -->
                </select>
            </div>
            <div class="mx-4 mb-5">
                <button type="submit" class="btn btn-sm btn-danger">Apply to Selected</button>
            </div>
        </div>
    </form>
</div>


<script>
    document.getElementById('select-all').addEventListener('change', function () {
        var checkboxes = document.querySelectorAll('input[name="selected_appointments"]');
        checkboxes.forEach(checkbox => checkbox.checked = this.checked);
    });
</script>
{% endblock %}